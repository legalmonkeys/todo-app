server:
  port: 7070

spring:
  datasource:
    # H2 file-based database with optimized settings
    url: jdbc:h2:file:./data/todoapp;DB_CLOSE_ON_EXIT=FALSE
    username: sa
    password:
    driver-class-name: org.h2.Driver
    hikari:
      # Connection pool optimization for local development
      maximum-pool-size: 10
      minimum-idle: 2
      connection-timeout: 20000
      idle-timeout: 300000
      max-lifetime: 1200000
  
  h2:
    console:
      enabled: true
      path: /h2-console
      settings:
        web-allow-others: false  # Security: only allow local access
        trace: false
  
  jpa:
    hibernate:
      ddl-auto: none  # Let Flyway manage schema
    show-sql: false
    properties:
      hibernate:
        format_sql: false
        use_sql_comments: false
  
  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true
    baseline-version: 1
    validate-on-migrate: true
    clean-disabled: true  # Security: prevent accidental data loss
  
  thymeleaf:
    cache: false  # Development setting
    check-template-location: false  # Suppress template warnings
  
  # Data source initialization
  sql:
    init:
      mode: never  # Let Flyway handle initialization

logging:
  level:
    com.todoapp: INFO
    org.springframework.web: INFO
    org.springframework.jdbc: DEBUG
    org.flywaydb: INFO
    org.springframework.data.jdbc: DEBUG
    REQUEST_LOGGER: INFO  # Request/response logging
  pattern:
    console: "%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"
  file:
    name: ./logs/todo-app.log
    max-size: 10MB
    max-history: 10

# Application-specific configuration
app:
  database:
    path: ./data/todoapp
    backup-enabled: false  # Can be enabled for production
  logging:
    requests:
      enabled: true
      include-static-resources: false
      include-health-checks: false
      max-user-agent-length: 50
      sanitize-sensitive-params: true
